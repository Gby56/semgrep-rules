rules:
  - id: spring-actuator-dangerous-endpoints
    patterns:
    - pattern-either:
      - pattern: management.endpoints.enabled-by-default=true
      - pattern: management.endpoints.web.exposure.include=*
      - pattern: management.endpoint.heapdump.enabled=true
      - pattern: management.endpoint.threaddump.enabled=true
      - pattern: management.endpoint.trace.enabled=true
      - pattern: management.endpoint.logfile.enabled=true
      - pattern: management.endpoint.env.enabled=true
      - pattern: management.endpoint.jolokia.enabled=true
      - pattern: management.endpoints.web.exposure.include=...heapdump...
      - pattern: management.endpoints.web.exposure.include=...threaddump...
      - pattern: management.endpoints.web.exposure.include=...trace...
      - pattern: management.endpoints.web.exposure.include=...logfile...
      - pattern: management.endpoints.web.exposure.include=...env...
      - pattern: management.endpoints.web.exposure.include=...jolokia...
    message: Spring Boot Actuator has dangerous endpoints enabled, which could dump the heap memory,
      threads, http trace, env variables, jolokia endpoints and more. 
      Check your usage before enabling this in production, especially on the same port as your REST application.
    severity: ERROR
    languages:
      - generic
    paths:
      include:
        - "*properties"
    metadata:
      owasp: "A6: Security Misconfiguration"
      references:
        - https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-features.html#production-ready-endpoints-exposing-endpoints
        - https://medium.com/walmartglobaltech/perils-of-spring-boot-actuators-misconfiguration-185c43a0f785
      category: security
      technology:
        - spring
      license: Commons Clause License Condition v1.0[LGPL-2.1-only]
